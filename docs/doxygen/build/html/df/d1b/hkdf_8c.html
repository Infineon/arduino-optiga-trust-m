<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OPTIGA Trust M: hkdf.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ifx_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OPTIGA Trust M
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
   <div id="projectbrief">C++ library for Optiga Trust M Chip Security Controller</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('df/d1b/hkdf_8c.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hkdf.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:add9dfaeb0544fe502c0240c9f90618ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1b/hkdf_8c.html#add9dfaeb0544fe502c0240c9f90618ed">mbedtls_hkdf</a> (const <a class="el" href="../../da/dca/structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *md, const unsigned char *salt, size_t salt_len, const unsigned char *ikm, size_t ikm_len, const unsigned char *info, size_t info_len, unsigned char *okm, size_t okm_len)</td></tr>
<tr class="memdesc:add9dfaeb0544fe502c0240c9f90618ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the HMAC-based Extract-and-Expand Key Derivation Function (HKDF).  <a href="../../df/d1b/hkdf_8c.html#add9dfaeb0544fe502c0240c9f90618ed">More...</a><br /></td></tr>
<tr class="separator:add9dfaeb0544fe502c0240c9f90618ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc52cb2585719ae429cd1be7e52d0a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1b/hkdf_8c.html#accc52cb2585719ae429cd1be7e52d0a4">mbedtls_hkdf_extract</a> (const <a class="el" href="../../da/dca/structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *md, const unsigned char *salt, size_t salt_len, const unsigned char *ikm, size_t ikm_len, unsigned char *prk)</td></tr>
<tr class="memdesc:accc52cb2585719ae429cd1be7e52d0a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take the input keying material <code>ikm</code> and extract from it a fixed-length pseudorandom key <code>prk</code>.  <a href="../../df/d1b/hkdf_8c.html#accc52cb2585719ae429cd1be7e52d0a4">More...</a><br /></td></tr>
<tr class="separator:accc52cb2585719ae429cd1be7e52d0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33043e5011a81ad50ed279f8e7d02a95"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1b/hkdf_8c.html#a33043e5011a81ad50ed279f8e7d02a95">mbedtls_hkdf_expand</a> (const <a class="el" href="../../da/dca/structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *md, const unsigned char *prk, size_t prk_len, const unsigned char *info, size_t info_len, unsigned char *okm, size_t okm_len)</td></tr>
<tr class="memdesc:a33043e5011a81ad50ed279f8e7d02a95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand the supplied <code>prk</code> into several additional pseudorandom keys, which is the output of the HKDF.  <a href="../../df/d1b/hkdf_8c.html#a33043e5011a81ad50ed279f8e7d02a95">More...</a><br /></td></tr>
<tr class="separator:a33043e5011a81ad50ed279f8e7d02a95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="add9dfaeb0544fe502c0240c9f90618ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9dfaeb0544fe502c0240c9f90618ed">&#9670;&nbsp;</a></span>mbedtls_hkdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_hkdf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/dca/structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>ikm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ikm_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>info_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>okm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>okm_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the HMAC-based Extract-and-Expand Key Derivation Function (HKDF). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">md</td><td>A hash function; md.size denotes the length of the hash function output in bytes. </td></tr>
    <tr><td class="paramname">salt</td><td>An optional salt value (a non-secret random value); if the salt is not provided, a string of all zeros of md.size length is used as the salt. </td></tr>
    <tr><td class="paramname">salt_len</td><td>The length in bytes of the optional <code>salt</code>. </td></tr>
    <tr><td class="paramname">ikm</td><td>The input keying material. </td></tr>
    <tr><td class="paramname">ikm_len</td><td>The length in bytes of <code>ikm</code>. </td></tr>
    <tr><td class="paramname">info</td><td>An optional context and application specific information string. This can be a zero-length string. </td></tr>
    <tr><td class="paramname">info_len</td><td>The length of <code>info</code> in bytes. </td></tr>
    <tr><td class="paramname">okm</td><td>The output keying material of <code>okm_len</code> bytes. </td></tr>
    <tr><td class="paramname">okm_len</td><td>The length of the output keying material in bytes. This must be less than or equal to 255 * md.size bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
#MBEDTLS_ERR_HKDF_BAD_INPUT_DATA when the parameters are invalid. </dd>
<dd>
An MBEDTLS_ERR_MD_* error for errors returned from the underlying MD layer. </dd></dl>

</div>
</div>
<a id="accc52cb2585719ae429cd1be7e52d0a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accc52cb2585719ae429cd1be7e52d0a4">&#9670;&nbsp;</a></span>mbedtls_hkdf_extract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_hkdf_extract </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/dca/structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>ikm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ikm_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>prk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take the input keying material <code>ikm</code> and extract from it a fixed-length pseudorandom key <code>prk</code>. </p>
<dl class="section warning"><dt>Warning</dt><dd>This function should only be used if the security of it has been studied and established in that particular context (eg. TLS 1.3 key schedule). For standard HKDF security guarantees use <code>mbedtls_hkdf</code> instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">md</td><td>A hash function; md.size denotes the length of the hash function output in bytes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">salt</td><td>An optional salt value (a non-secret random value); if the salt is not provided, a string of all zeros of md.size length is used as the salt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">salt_len</td><td>The length in bytes of the optional <code>salt</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ikm</td><td>The input keying material. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ikm_len</td><td>The length in bytes of <code>ikm</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prk</td><td>A pseudorandom key of at least md.size bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
#MBEDTLS_ERR_HKDF_BAD_INPUT_DATA when the parameters are invalid. </dd>
<dd>
An MBEDTLS_ERR_MD_* error for errors returned from the underlying MD layer. </dd></dl>

</div>
</div>
<a id="a33043e5011a81ad50ed279f8e7d02a95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33043e5011a81ad50ed279f8e7d02a95">&#9670;&nbsp;</a></span>mbedtls_hkdf_expand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_hkdf_expand </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/dca/structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>prk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>prk_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>info_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>okm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>okm_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Expand the supplied <code>prk</code> into several additional pseudorandom keys, which is the output of the HKDF. </p>
<dl class="section warning"><dt>Warning</dt><dd>This function should only be used if the security of it has been studied and established in that particular context (eg. TLS 1.3 key schedule). For standard HKDF security guarantees use <code>mbedtls_hkdf</code> instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">md</td><td>A hash function; md.size denotes the length of the hash function output in bytes. </td></tr>
    <tr><td class="paramname">prk</td><td>A pseudorandom key of at least md.size bytes. <code>prk</code> is usually the output from the HKDF extract step. </td></tr>
    <tr><td class="paramname">prk_len</td><td>The length in bytes of <code>prk</code>. </td></tr>
    <tr><td class="paramname">info</td><td>An optional context and application specific information string. This can be a zero-length string. </td></tr>
    <tr><td class="paramname">info_len</td><td>The length of <code>info</code> in bytes. </td></tr>
    <tr><td class="paramname">okm</td><td>The output keying material of <code>okm_len</code> bytes. </td></tr>
    <tr><td class="paramname">okm_len</td><td>The length of the output keying material in bytes. This must be less than or equal to 255 * md.size bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
#MBEDTLS_ERR_HKDF_BAD_INPUT_DATA when the parameters are invalid. </dd>
<dd>
An MBEDTLS_ERR_MD_* error for errors returned from the underlying MD layer. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d1b/hkdf_8c_a33043e5011a81ad50ed279f8e7d02a95_cgraph.png" border="0" usemap="#adf/d1b/hkdf_8c_a33043e5011a81ad50ed279f8e7d02a95_cgraph" alt=""/></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_7f7598ebb7008b1972f2cc3333f8faed.html">mbedtls</a></li><li class="navelem"><a class="el" href="../../df/d1b/hkdf_8c.html">hkdf.c</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
